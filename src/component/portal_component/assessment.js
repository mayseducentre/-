import React, { useState } from "react";

const Assessment = () => {
  const [selectedClass, setSelectedClass] = useState("");
    const [selectedSubject, setSelectedSubject] = useState("");
      const [sheetUrl, setSheetUrl] = useState("");

        const classes = [
            "Class 1", "Class 2", "Class 3",
                "Class 4", "Class 5", "Class 6",
                    "JHS 1", "JHS 2", "JHS 3"
                      ];

                        const subjects = [
                            "Ga", "Computing", "Creative Art", "Math", "Science",
                                "History", "Owop", "French", "Social", "English",
                                    "Career Tech", "RME"
                                      ];

                                        // Link store â€” you can add more
                                          const sheetLinks = {
                                              "Computing_JHS 1": "https://docs.google.com/spreadsheets/d/1oJU0E8cdQIVdPePm2BJAWLyTeJuoXDy65SQQx8d9z9A/edit"
                                                };

                                                  const handleLoad = () => {
                                                      const key = `${selectedSubject}_${selectedClass}`;
                                                          const link = sheetLinks[key];

                                                              if (link) {
                                                                    const embedLink = link.replace("/edit", "/preview");
                                                                          setSheetUrl(embedLink);
                                                                              } else {
                                                                                    alert("No Google Sheet found for this selection.");
                                                                                        }
                                                                                          };

                                                                                            const handleEdit = () => {
                                                                                                const key = `${selectedSubject}_${selectedClass}`;
                                                                                                    const link = sheetLinks[key];
                                                                                                        if (link) {
                                                                                                              const editLink = link.replace("/edit", "/edit?pli=1&authuser=0");
                                                                                                                    window.open(editLink, "_blank");
                                                                                                                        } else {
                                                                                                                              alert("No editable link found.");
                                                                                                                                  }
                                                                                                                                    };

                                                                                                                                      return (
                                                                                                                                          <div style={{
                                                                                                                                                fontFamily: "Arial, sans-serif",
                                                                                                                                                      maxWidth: "900px",
                                                                                                                                                            margin: "2rem auto",
                                                                                                                                                                  padding: "2rem",
                                                                                                                                                                        border: "1px solid #e0e0e0",
                                                                                                                                                                              borderRadius: "12px",
                                                                                                                                                                                    boxShadow: "0 8px 24px rgba(0,0,0,0.1)"
                                                                                                                                                                                        }}>
                                                                                                                                                                                              <h1 style={{
                                                                                                                                                                                                      fontSize: "28px",
                                                                                                                                                                                                              textAlign: "center",
                                                                                                                                                                                                                      marginBottom: "2rem",
                                                                                                                                                                                                                              color: "#2c3e50"
                                                                                                                                                                                                                                    }}>
                                                                                                                                                                                                                                            Excel Assessment Sheet
                                                                                                                                                                                                                                                  </h1>

                                                                                                                                                                                                                                                        <div style={{ marginBottom: "1rem" }}>
                                                                                                                                                                                                                                                                <label style={{ display: "block", marginBottom: "6px", fontWeight: "bold" }}>Select Class:</label>
                                                                                                                                                                                                                                                                        <select
                                                                                                                                                                                                                                                                                  value={selectedClass}
                                                                                                                                                                                                                                                                                            onChange={(e) => setSelectedClass(e.target.value)}
                                                                                                                                                                                                                                                                                                      style={{
                                                                                                                                                                                                                                                                                                                  padding: "10px",
                                                                                                                                                                                                                                                                                                                              width: "100%",
                                                                                                                                                                                                                                                                                                                                          borderRadius: "6px",
                                                                                                                                                                                                                                                                                                                                                      border: "1px solid #ccc"
                                                                                                                                                                                                                                                                                                                                                                }}
                                                                                                                                                                                                                                                                                                                                                                        >
                                                                                                                                                                                                                                                                                                                                                                                  <option value="">-- Choose Class --</option>
                                                                                                                                                                                                                                                                                                                                                                                            {classes.map((cls) => (
                                                                                                                                                                                                                                                                                                                                                                                                        <option key={cls} value={cls}>{cls}</option>
                                                                                                                                                                                                                                                                                                                                                                                                                  ))}
                                                                                                                                                                                                                                                                                                                                                                                                                          </select>
                                                                                                                                                                                                                                                                                                                                                                                                                                </div>

                                                                                                                                                                                                                                                                                                                                                                                                                                      <div style={{ marginBottom: "1rem" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                              <label style={{ display: "block", marginBottom: "6px", fontWeight: "bold" }}>Select Subject:</label>
                                                                                                                                                                                                                                                                                                                                                                                                                                                      <select
                                                                                                                                                                                                                                                                                                                                                                                                                                                                value={selectedSubject}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          onChange={(e) => setSelectedSubject(e.target.value)}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    style={{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                padding: "10px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            width: "100%",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        borderRadius: "6px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    border: "1px solid #ccc"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <option value="">-- Choose Subject --</option>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          {subjects.map((subj) => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <option key={subj} value={subj}>{subj}</option>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </select>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <div style={{ display: "flex", gap: "1rem", marginBottom: "1.5rem" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <button
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      onClick={handleLoad}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                style={{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            padding: "12px 20px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        backgroundColor: "#3498db",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    color: "#fff",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                border: "none",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            borderRadius: "6px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cursor: "pointer",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    fontWeight: "bold"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Load Sheet
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          onClick={handleEdit}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    style={{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                padding: "12px 20px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            backgroundColor: "#2ecc71",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        color: "#fff",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    border: "none",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                borderRadius: "6px",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cursor: "pointer",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        fontWeight: "bold"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Edit in New Tab
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        {sheetUrl && (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <iframe
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          title="Google Sheet Preview"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    src={sheetUrl}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              width="100%"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        height="600px"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  style={{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              border: "1px solid #ccc",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          borderRadius: "6px"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        export default Assessment;